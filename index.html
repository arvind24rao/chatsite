<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>Loop — Live Demo (A, B, Bot→A, Bot→B)</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Fail-safe minimal styles in case style.css doesn't load yet */
    :root { --bg:#0b0b0c; --fg:#ffffff; --muted:#b4b4b7; --panel:#121216; --line:#1e1e24; }
    * { box-sizing: border-box; }
    body { margin: 0; background: var(--bg); color: var(--fg); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
    header { padding: 16px; border-bottom: 1px solid var(--line); }
    .controls { display: grid; grid-template-columns: repeat(12, 1fr); gap: 8px; align-items: center; }
    .controls .field { grid-column: span 3; display: flex; flex-direction: column; gap: 6px; }
    .controls .field label { font-size: 12px; color: var(--muted); }
    .controls input[type="text"] { width: 100%; padding: 10px 12px; background: #0e0e12; color: var(--fg); border: 1px solid var(--line); border-radius: 10px; }
    .controls button { padding: 10px 12px; background: #1c64f2; color: #fff; border: 0; border-radius: 10px; cursor: pointer; }
    .controls button.secondary { background: #2a2a33; color: var(--fg); }
    .controls .spacer { grid-column: span 12; height: 2px; background: var(--line); margin: 4px 0; }
    main { padding: 16px; }
    .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
    .panel { background: var(--panel); border: 1px solid var(--line); border-radius: 14px; display: flex; flex-direction: column; min-height: 42vh; }
    .panel header { border: 0; padding: 12px 14px; display: flex; align-items: center; justify-content: space-between; }
    .panel header h2 { margin: 0; font-size: 14px; letter-spacing: 0.2px; color: var(--muted); }
    .feed { padding: 12px 14px; overflow: auto; display: flex; flex-direction: column; gap: 10px; border-top: 1px solid var(--line); border-bottom: 1px solid var(--line); min-height: 28vh; }
    .msg { padding: 10px 12px; background: #0e0e12; border: 1px solid var(--line); border-radius: 10px; white-space: pre-wrap; word-break: break-word; }
    .meta { font-size: 11px; color: var(--muted); margin-top: 6px; }
    .composer { padding: 12px 14px; display: grid; grid-template-columns: 1fr auto; gap: 8px; }
    .composer input[type="text"] { padding: 10px 12px; background: #0e0e12; color: var(--fg); border: 1px solid var(--line); border-radius: 10px; }
    .composer button { padding: 10px 12px; background: #1c64f2; color: #fff; border: 0; border-radius: 10px; cursor: pointer; }
    .hint { font-size: 12px; color: var(--muted); padding: 8px 14px 0; }
    .statusbar { padding: 8px 0 0; font-size: 12px; color: var(--muted); }
    @media (max-width: 1100px) { .grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 640px) { .grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <header>
    <div class="controls">
      <div class="field" style="grid-column: span 4;">
        <label for="threadId">Thread ID (UUID)</label>
        <input id="threadId" type="text" placeholder="e.g. 11111111-2222-3333-4444-555555555555" />
      </div>
      <div class="field" style="grid-column: span 4;">
        <label for="userAId">User A — Profile ID (UUID)</label>
        <input id="userAId" type="text" placeholder="Profile UUID for A" />
      </div>
      <div class="field" style="grid-column: span 4;">
        <label for="userBId">User B — Profile ID (UUID)</label>
        <input id="userBId" type="text" placeholder="Profile UUID for B" />
      </div>

      <div class="spacer"></div>

      <div class="field" style="grid-column: span 3;">
        <button id="saveConfig" class="secondary">Save IDs</button>
        <div class="statusbar" id="configStatus">Enter IDs and click Save.</div>
      </div>
      <div class="field" style="grid-column: span 3;">
        <button id="refreshBoth" class="secondary">Refresh A & B</button>
        <div class="statusbar">Manually pulls both panes once.</div>
      </div>
      <div class="field" style="grid-column: span 3;">
        <button id="togglePolling" class="secondary" data-running="false">Start Polling</button>
        <div class="statusbar">Toggles 2s polling of both panes.</div>
      </div>
      <div class="field" style="grid-column: span 3;">
        <button id="processBot" title="POST /bot/process">Process Bot Queue</button>
        <div class="statusbar">Calls /bot/process (requires bot auth in backend).</div>
      </div>
    </div>
  </header>

  <main>
    <div class="grid">
      <!-- Human A -->
      <section class="panel" id="panelA" data-role="humanA">
        <header><h2>Human A → Bot (inbox_to_bot)</h2></header>
        <div class="hint">Shows A’s own messages to the Bot (audience = inbox_to_bot, created_by = A).</div>
        <div class="feed" id="feedA" aria-live="polite"></div>
        <div class="composer">
          <input id="inputA" type="text" placeholder="Type as A…" />
          <button id="sendA">Send as A</button>
        </div>
      </section>

      <!-- Human B -->
      <section class="panel" id="panelB" data-role="humanB">
        <header><h2>Human B → Bot (inbox_to_bot)</h2></header>
        <div class="hint">Shows B’s own messages to the Bot (audience = inbox_to_bot, created_by = B).</div>
        <div class="feed" id="feedB" aria-live="polite"></div>
        <div class="composer">
          <input id="inputB" type="text" placeholder="Type as B…" />
          <button id="sendB">Send as B</button>
        </div>
      </section>

      <!-- Bot → A -->
      <section class="panel" id="panelBotA" data-role="botToA">
        <header><h2>Bot → A (bot_to_user)</h2></header>
        <div class="hint">Shows the bot’s DMs to A (audience = bot_to_user, recipient_profile_id = A).</div>
        <div class="feed" id="feedBotA" aria-live="polite"></div>
      </section>

      <!-- Bot → B -->
      <section class="panel" id="panelBotB" data-role="botToB">
        <header><h2>Bot → B (bot_to_user)</h2></header>
        <div class="hint">Shows the bot’s DMs to B (audience = bot_to_user, recipient_profile_id = B).</div>
        <div class="feed" id="feedBotB" aria-live="polite"></div>
      </section>
    </div>
  </main>

  <script src="app.js"></script>
</body>
</html>